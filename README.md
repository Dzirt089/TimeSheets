# TimeSheets
Программа для учёта рабочего времени. Или просто - Табель.
Разработана для ведения отработанных часов персонала, вместо многих файлов Excel. 
На основе моей узкоспециализированной версии для предприятия, 
данная версия программы адаптированна для широкого круга применения. 

При разработке программы с нуля, я столкнулся с отсутствием подобных программ с открытым исходным кодом. Встретил только платные веб версии или Desctop - программы, но очень древние версии.
Поэтому я выкладываю в открытый доступ свой проект.

Программа разработана на .Net 9.0
WPF с MVVM
с применением EF Core,
в качестве БД использую SQL Server (EF Core настроен на неё). 
Также используется minimal api для формирования FastReport - файлов, (Добавлю её в начале 2025 г.) отчётов.

Имеет главный вид:
-
Где также желтым оттенком окрашены выходные дни по производственному каледарю 2024г. и 2025г.

![Скриншот программы](https://github.com/user-attachments/assets/f2d592a5-116a-43bd-8db3-a2f0a7918297)

Программа разработанна на основе рабочих смен предприятия. Я оставил их для наглядности. 
Так как при необходимости - это можно изменить в коде программы, поменять на свои данные.
Справка о сменах имеется, она вызывается по кнопке "?":

![Справка](https://github.com/user-attachments/assets/3524dc5d-6ae1-4716-99fb-a9f96b3dd467)


Программа умеет:
--
 - Вести по сменам часы отработанного времени (кроме уволенных)
 - Вести переработки
 - Вести недоработки (например, когда человек отпросился пораньше по слубной записке)
 - Если предприятие (или иная организация) кормит свои сотрудников, то 
![Галочка обеда](https://github.com/user-attachments/assets/f9f66d2e-b893-47a1-ae51-bf5d10538ba8)
   Можно по ПКМ установить обед для сотрудника (при этом появится галочка перед его ФИО) для автоматического заказа из api.

   
 - По меню ПКМ также можно:
   --
![Меню ПКМ](https://github.com/user-attachments/assets/7751a92a-1152-4c3b-952a-885d849ba08d)

    1) уволить сотрудника
    2) отменить увольнение
    3) редактировать вручную обеды (проставить или снять отметку)

- Увольнение имеет вид:
  --
![Увольнение](https://github.com/user-attachments/assets/32d7fce2-3ebd-4f2f-a0fc-59ca3ebad82a)
  1) Если у человека стоит график "наперёд", то при увольнении по выбранной дате - все дальнейшие даты анулируются.
  2) ФИО сотрудника окрашивается в красный цвет.
  3) После увольнения нельзя редактировать смены у сотрудника
![Увольнение человека](https://github.com/user-attachments/assets/e680541e-9bce-42d3-9a9a-641faa4819c0)

Добавление сотрудников происходит через картотеку.
--
Имеет вид:
![Картотека](https://github.com/user-attachments/assets/d06d79c2-f0e0-4695-b90e-41dfd27d4e20)

Картотека умеет:
 - 
 1) Создать сотрудника
 2) Загрузить фотографию сотрудника.
 3) Изменить данные сотрудника.
 4) Уволить сотрудника
 5) Показать уволенных сотрудников

Итоги табеля отображает данные по выбранному участку и датам:
-
![Итоги табеля](https://github.com/user-attachments/assets/6d2ad51e-b0d3-4ddd-b289-077fcbf098f2)

Умеет обновлять данные и через api сохранять данные в формате Excel на компьютере.


Быстрый Старт:
--
1) На примере SQL Server
   в файле Settings.settings установить название своей БД, например:
Server=ВАШЕ_ИМЯ; Initial Catalog = TimeSheet; Database=TimeSheet; Trusted_Connection=True;  TrustServerCertificate=True; Encrypt=False; Application Name = TimeSheets;
2) В OnModelCreating при создании указаны для заполнения участки:
entity.HasData(new DepartmentProduction { DepartmentID = "01", NameDepartment = "Группа разработки" }
, new DepartmentProduction { DepartmentID = "02", NameDepartment = "Группа аналитики" }
, new DepartmentProduction { DepartmentID = "03", NameDepartment = "Группа тестирования" }
, new DepartmentProduction { DepartmentID = "04", NameDepartment = "Группа исследования" });

При необходимости поменяйте на свои данные.

3) В PowerShell для разработчиков ввести:
   dotnet ef database update --project TimeSheets




